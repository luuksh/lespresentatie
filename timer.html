<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Klas Timer</title>
  <style>
    :root {
      --bg-1: #0f1d35;
      --bg-2: #172b49;
      --card: #1f365a;
      --line: rgba(190, 212, 245, 0.28);
      --text: #edf4ff;
      --muted: #bdd0ee;
      --accent: #64c5ff;
      --accent-deep: #2b95f5;
      --good: #39d78b;
      --warn: #f5c15b;
      --danger: #ff7171;
      --font-ui: "Avenir Next", "Segoe UI", "Helvetica Neue", Arial, sans-serif;
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }

    body {
      margin: 0;
      padding: 10px;
      font-family: var(--font-ui);
      color: var(--text);
      background:
        radial-gradient(380px 220px at 20% 8%, rgba(71, 132, 218, 0.26), transparent 64%),
        linear-gradient(180deg, var(--bg-2) 0%, var(--bg-1) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .timer {
      width: min(360px, 100%);
      border-radius: 20px;
      border: 1px solid var(--line);
      background:
        linear-gradient(180deg, rgba(43, 70, 111, 0.94), rgba(25, 43, 73, 0.94));
      box-shadow:
        0 14px 28px rgba(4, 12, 26, 0.45),
        inset 0 1px 0 rgba(255, 255, 255, 0.08);
      padding: 12px;
      display: grid;
      gap: 10px;
    }

    .head {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
    }

    .title {
      margin: 0;
      font-size: 16px;
      font-weight: 900;
      letter-spacing: 0.01em;
      display: flex;
      align-items: center;
      gap: 7px;
    }

    .kbd {
      border: 1px solid rgba(190, 212, 245, 0.35);
      border-radius: 999px;
      padding: 3px 8px;
      font-size: 11px;
      color: var(--muted);
      white-space: nowrap;
    }

    .clock-wrap {
      display: grid;
      place-items: center;
      padding: 2px 0;
      gap: 8px;
    }

    .clock {
      position: relative;
      width: 220px;
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      border: 9px solid rgba(192, 215, 248, 0.22);
      background:
        radial-gradient(circle at 50% 35%, #325684 0%, #162f4f 55%, #0f1f36 100%);
      box-shadow:
        inset 0 2px 0 rgba(255, 255, 255, 0.08),
        inset 0 -14px 24px rgba(5, 12, 22, 0.45),
        0 14px 24px rgba(7, 16, 31, 0.4);
      overflow: hidden;
      touch-action: none;
      cursor: crosshair;
    }

    .bezel {
      position: absolute;
      inset: 5px;
      z-index: 0;
      border-radius: 50%;
      border: 1px solid rgba(200, 224, 255, 0.24);
      box-shadow: inset 0 0 0 8px rgba(6, 16, 30, 0.22);
    }

    .dial {
      position: absolute;
      inset: 0;
      z-index: 1;
    }

    .tick {
      position: absolute;
      z-index: 1;
      left: 50%;
      top: 11px;
      width: 2px;
      height: 9px;
      border-radius: 2px;
      background: rgba(213, 227, 248, 0.55);
      transform-origin: 50% calc(110px - 11px);
    }

    .tick.big {
      width: 3px;
      height: 16px;
      background: rgba(235, 244, 255, 0.78);
    }

    .progress {
      position: absolute;
      z-index: 0;
      inset: 8px;
      border-radius: 50%;
      background: conic-gradient(var(--accent) calc(var(--pct, 0) * 1%), rgba(164, 198, 245, 0.08) 0);
      mix-blend-mode: screen;
      opacity: 0.92;
      pointer-events: none;
    }

    .hand {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 5px;
      height: 78px;
      border-radius: 5px;
      background: linear-gradient(180deg, #b5ebff 0%, #45afff 80%);
      transform-origin: 50% 88%;
      transform: translate(-50%, -88%) rotate(var(--angle, 0deg));
      box-shadow: 0 0 10px rgba(89, 191, 255, 0.32);
      z-index: 2;
    }

    .hand::after {
      content: "";
      position: absolute;
      left: 50%;
      bottom: -12px;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #dff5ff;
      transform: translateX(-50%);
      box-shadow: 0 0 10px rgba(118, 206, 255, 0.48);
    }

    .hub {
      position: absolute;
      left: 50%;
      top: 50%;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      z-index: 4;
      transform: translate(-50%, -50%);
      background: radial-gradient(circle at 35% 35%, #f1fbff, #8ed3ff 65%, #4a97cc 100%);
      border: 1px solid rgba(255, 255, 255, 0.5);
    }

    .numeral {
      position: absolute;
      z-index: 2;
      font-size: 14px;
      font-weight: 900;
      letter-spacing: 0.02em;
      color: rgba(228, 241, 255, 0.92);
      text-shadow: 0 1px 1px rgba(4, 12, 23, 0.5);
    }

    .numeral.n12 { left: 50%; top: 18px; transform: translateX(-50%); }
    .numeral.n3 { right: 18px; top: 50%; transform: translateY(-50%); }
    .numeral.n6 { left: 50%; bottom: 48px; transform: translateX(-50%); }
    .numeral.n9 { left: 18px; top: 50%; transform: translateY(-50%); }

    .digital {
      position: absolute;
      left: 50%;
      bottom: 34px;
      transform: translateX(-50%);
      width: 150px;
      border-radius: 10px;
      border: 1px solid rgba(197, 218, 246, 0.26);
      background: rgba(8, 20, 36, 0.42);
      text-align: center;
      padding: 6px 8px 7px;
      z-index: 3;
    }

    .time {
      font-size: 40px;
      font-weight: 900;
      line-height: 1;
      font-variant-numeric: tabular-nums;
      letter-spacing: 0.02em;
    }

    .state {
      margin-top: 3px;
      font-size: 12px;
      color: var(--muted);
      font-weight: 700;
    }

    .scrub-hint {
      font-size: 11px;
      font-weight: 700;
      color: var(--muted);
      text-align: center;
    }

    .panel {
      border: 1px solid rgba(186, 210, 246, 0.24);
      border-radius: 14px;
      background: linear-gradient(180deg, rgba(26, 48, 82, 0.55), rgba(20, 37, 66, 0.5));
      padding: 10px;
      display: grid;
      gap: 8px;
    }

    .quick {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 6px;
    }

    .set {
      display: grid;
      grid-template-columns: auto 1fr auto 1fr auto;
      gap: 6px;
      align-items: center;
    }

    .set label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.06em;
      font-weight: 800;
    }

    .set span {
      text-align: center;
      color: var(--muted);
      font-weight: 800;
    }

    input[type="number"] {
      height: 36px;
      border-radius: 10px;
      border: 1px solid rgba(186, 210, 246, 0.3);
      background: rgba(8, 18, 33, 0.48);
      color: var(--text);
      text-align: center;
      font-size: 15px;
      font-weight: 800;
      font-variant-numeric: tabular-nums;
      padding: 0 6px;
    }

    input[type="number"]:focus {
      outline: none;
      border-color: rgba(100, 197, 255, 0.8);
      box-shadow: 0 0 0 2px rgba(100, 197, 255, 0.22);
    }

    .row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .row > * { flex: 1; }

    .btn {
      height: 36px;
      border: 1px solid rgba(186, 210, 246, 0.26);
      border-radius: 10px;
      color: var(--text);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.11), rgba(255, 255, 255, 0.04));
      font-size: 13px;
      font-weight: 800;
      letter-spacing: 0.01em;
      cursor: pointer;
      transition: transform 0.08s ease, border-color 0.14s ease, filter 0.15s ease;
    }

    .btn:hover { border-color: rgba(201, 224, 255, 0.52); }
    .btn:active { transform: translateY(1px); }

    .btn.primary {
      color: #06223f;
      border-color: transparent;
      background: linear-gradient(180deg, var(--accent), var(--accent-deep));
      box-shadow: 0 8px 18px rgba(43, 149, 245, 0.28);
    }

    .btn.warn {
      color: #3d2a00;
      border-color: transparent;
      background: linear-gradient(180deg, #ffd9a0, var(--warn));
    }

    .btn.ghost {
      background: linear-gradient(180deg, rgba(196, 216, 247, 0.16), rgba(196, 216, 247, 0.08));
    }

    .clock.done {
      animation: glow 0.9s ease-in-out infinite;
      border-color: rgba(255, 154, 154, 0.56);
      box-shadow:
        0 0 0 5px rgba(255, 113, 113, 0.2),
        inset 0 2px 0 rgba(255, 255, 255, 0.08),
        inset 0 -14px 24px rgba(5, 12, 22, 0.45),
        0 14px 24px rgba(7, 16, 31, 0.4);
    }

    @keyframes glow {
      0% { transform: scale(1); }
      50% { transform: scale(1.015); }
      100% { transform: scale(1); }
    }
  </style>
</head>
<body>
  <div class="timer" role="timer" aria-live="polite">
    <div class="head">
      <h1 class="title">ðŸ•’ Kloktimer</h1>
      <div class="kbd">spatie start/pauze Â· R/Esc reset</div>
    </div>

    <div class="clock-wrap">
      <div class="clock" id="clock" aria-label="Aftelklok">
        <div class="bezel"></div>
        <div class="progress" id="ring"></div>
        <div class="dial" id="dial"></div>
        <div class="hand" id="hand"></div>
        <div class="hub"></div>
        <div class="numeral n12">12</div>
        <div class="numeral n3">3</div>
        <div class="numeral n6">6</div>
        <div class="numeral n9">9</div>
        <div class="digital">
          <div class="time" id="time">05:00</div>
          <div class="state" id="state">Gepauzeerd</div>
        </div>
      </div>
      <div class="scrub-hint">Sleep over de klok om tijd te zetten</div>
    </div>

    <div class="panel" aria-label="Timerbediening">
      <div class="quick">
        <button class="btn ghost" data-pres="60">+1m</button>
        <button class="btn ghost" data-pres="180">+3m</button>
        <button class="btn ghost" data-pres="300">+5m</button>
        <button class="btn ghost" data-pres="600">+10m</button>
        <button class="btn ghost" data-pres="30">+30s</button>
        <button class="btn ghost" data-pres="-30">âˆ’30s</button>
      </div>

      <div class="set">
        <label for="min">Min</label>
        <input id="min" type="number" min="0" max="999" value="5" aria-label="Minuten" />
        <span>:</span>
        <input id="sec" type="number" min="0" max="59" value="0" aria-label="Seconden" />
        <button class="btn warn" id="apply">Zet</button>
      </div>

      <div class="row">
        <button class="btn primary" id="startPause">Start</button>
        <button class="btn" id="reset">Reset</button>
      </div>
    </div>
  </div>

  <script>
    let total = 300;
    let remaining = total;
    let running = false;
    let intervalId = null;

    const timeEl = document.getElementById('time');
    const stateEl = document.getElementById('state');
    const ringEl = document.getElementById('ring');
    const handEl = document.getElementById('hand');
    const clockEl = document.getElementById('clock');
    const dialEl = document.getElementById('dial');
    const startBtn = document.getElementById('startPause');
    const resetBtn = document.getElementById('reset');
    const applyBtn = document.getElementById('apply');
    const minIn = document.getElementById('min');
    const secIn = document.getElementById('sec');

    const clamp = (v, lo, hi) => Math.max(lo, Math.min(hi, v));

    function fmt(seconds) {
      const m = Math.floor(seconds / 60);
      const s = seconds % 60;
      return `${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
    }

    function syncInputsFrom(value) {
      const m = Math.floor(value / 60);
      const s = value % 60;
      minIn.value = String(m);
      secIn.value = String(s);
    }

    function updateDigits() {
      timeEl.textContent = fmt(remaining);
      if (remaining === 0 && !running) {
        stateEl.textContent = 'Klaar';
      } else {
        stateEl.textContent = running ? 'Bezig' : 'Gepauzeerd';
      }
    }

    function updateClock() {
      const done = total > 0 ? (total - remaining) / total : 0;
      ringEl.style.setProperty('--pct', (done * 100).toFixed(4));

      const angle = done * 360;
      handEl.style.setProperty('--angle', `${angle}deg`);
      clockEl.classList.toggle('done', remaining === 0);
    }

    function setByAngle(clientX, clientY) {
      if (total <= 0) total = 300;
      const rect = clockEl.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const dx = clientX - cx;
      const dy = clientY - cy;
      let angle = Math.atan2(dy, dx) * (180 / Math.PI) + 90;
      if (angle < 0) angle += 360;
      const done = angle / 360;
      remaining = clamp(Math.round(total * (1 - done)), 0, total);
      syncInputsFrom(remaining);
      updateDigits();
      updateClock();
    }

    function setFromInputs() {
      const m = clamp(parseInt(minIn.value, 10) || 0, 0, 999);
      const s = clamp(parseInt(secIn.value, 10) || 0, 0, 59);
      total = m * 60 + s;
      remaining = total;
      running = false;
      clearInterval(intervalId);
      startBtn.textContent = 'Start';
      updateDigits();
      updateClock();
    }

    function applyPreset(delta) {
      const next = clamp(remaining + delta, 0, 999 * 60 + 59);
      remaining = next;
      if (!running) total = next;
      syncInputsFrom(!running ? total : remaining);
      updateDigits();
      updateClock();
    }

    function tick() {
      if (!running) return;

      if (remaining <= 0) {
        clearInterval(intervalId);
        running = false;
        startBtn.textContent = 'Start';
        updateDigits();
        updateClock();
        if (navigator.vibrate) navigator.vibrate([180, 90, 180]);
        return;
      }

      remaining -= 1;
      updateDigits();
      updateClock();
    }

    function start() {
      if (remaining <= 0 && total > 0) remaining = total;
      if (remaining <= 0) return;

      running = true;
      startBtn.textContent = 'Pauze';
      clearInterval(intervalId);
      intervalId = setInterval(tick, 1000);
      updateDigits();
    }

    function pause() {
      running = false;
      clearInterval(intervalId);
      startBtn.textContent = 'Start';
      updateDigits();
    }

    function reset() {
      running = false;
      clearInterval(intervalId);
      remaining = total;
      startBtn.textContent = 'Start';
      syncInputsFrom(total);
      updateDigits();
      updateClock();
    }

    startBtn.addEventListener('click', () => (running ? pause() : start()));
    resetBtn.addEventListener('click', reset);
    applyBtn.addEventListener('click', setFromInputs);

    document.querySelectorAll('[data-pres]').forEach(btn => {
      btn.addEventListener('click', () => applyPreset(parseInt(btn.dataset.pres, 10)));
    });

    window.addEventListener('keydown', (e) => {
      const hardReload = (e.metaKey || e.ctrlKey) && e.shiftKey && e.code === 'KeyR';
      if (hardReload) {
        window.location.reload();
        return;
      }

      if (e.target && (e.target.tagName === 'INPUT' || e.target.isContentEditable)) return;
      if (e.code === 'Space') {
        e.preventDefault();
        running ? pause() : start();
      }
      const plainR = e.code === 'KeyR' && !e.metaKey && !e.ctrlKey && !e.altKey && !e.shiftKey;
      if (plainR || e.code === 'Escape') {
        e.preventDefault();
        reset();
      }
    });

    function drawTicks() {
      for (let i = 0; i < 60; i++) {
        const tick = document.createElement('div');
        tick.className = `tick${i % 5 === 0 ? ' big' : ''}`;
        tick.style.transform = `translateX(-50%) rotate(${i * 6}deg)`;
        dialEl.appendChild(tick);
      }
    }

    let scrubbing = false;
    const stopScrub = () => { scrubbing = false; };
    clockEl.addEventListener('pointerdown', (e) => {
      if (running) pause();
      scrubbing = true;
      clockEl.setPointerCapture(e.pointerId);
      setByAngle(e.clientX, e.clientY);
    });
    clockEl.addEventListener('pointermove', (e) => {
      if (!scrubbing) return;
      setByAngle(e.clientX, e.clientY);
    });
    clockEl.addEventListener('pointerup', stopScrub);
    clockEl.addEventListener('pointercancel', stopScrub);

    drawTicks();
    syncInputsFrom(total);
    updateDigits();
    updateClock();
  </script>
</body>
</html>
